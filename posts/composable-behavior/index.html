<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='When I first learned React ⚛, it took me less than a day to run into the ol&rsquo; &ldquo;controlled vs uncontrolled components&rdquo; dichotomy. At the time, I didn&rsquo;t even know the terms &ldquo;controlled&rdquo; and &ldquo;uncontrolled&rdquo;, but was still struggling to fit the designs in my head into those two buckets.
The tension was between 2 competing goals:
 I want to make my components as reusable as possible My use-cases were similar, but not exactly the same&hellip;  Here&rsquo;s a checkbox component that takes care of styling and toggling when clicked.'>
<meta name='theme-color' content='#00adb5'>

<meta property='og:title' content='Composable Behavior with React Hooks • Pedro Cattori'>
<meta property='og:description' content='When I first learned React ⚛, it took me less than a day to run into the ol&rsquo; &ldquo;controlled vs uncontrolled components&rdquo; dichotomy. At the time, I didn&rsquo;t even know the terms &ldquo;controlled&rdquo; and &ldquo;uncontrolled&rdquo;, but was still struggling to fit the designs in my head into those two buckets.
The tension was between 2 competing goals:
 I want to make my components as reusable as possible My use-cases were similar, but not exactly the same&hellip;  Here&rsquo;s a checkbox component that takes care of styling and toggling when clicked.'>
<meta property='og:url' content='http://www.github.pcattori.io/posts/composable-behavior/'>
<meta property='og:site_name' content='Pedro Cattori'>
<meta property='og:type' content='article'><meta property='article:section' content='posts'><meta property='article:tag' content='React'><meta property='article:published_time' content='2019-11-14T21:07:19-05:00'/><meta property='article:modified_time' content='2019-11-14T21:07:19-05:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.59.1" />

  <title>Composable Behavior with React Hooks • Pedro Cattori</title>
  <link rel='canonical' href='http://www.github.pcattori.io/posts/composable-behavior/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.6a060eb7.css'><style>
:root{--color-accent:#00adb5;}
</style>

  

</head>
<body class='page type-posts'>

  <div class='site'>

    <div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/'>Blog</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'>
            <h1 class='site-title title'>Composable Behavior with React Hooks</h1>
            <p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Composable Behavior with React Hooks</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2019-11-14T21:07:19-05:00'>2019, Nov 14</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
7 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  

<p>When I first learned <a href="https://reactjs.org/" target="_blank">React</a> ⚛, it took me less than a day to run into the ol&rsquo; <a href="https://reactjs.org/docs/uncontrolled-components.html" target="_blank">&ldquo;controlled vs uncontrolled components&rdquo;</a> dichotomy.
At the time, I didn&rsquo;t even know the terms &ldquo;controlled&rdquo; and &ldquo;uncontrolled&rdquo;, but was still struggling to fit the designs in my head into those two buckets.</p>

<p>The tension was between 2 competing goals:</p>

<ol>
<li>I want to make my components as <strong>reusable</strong> as possible</li>
<li>My use-cases were <em>similar</em>, but <strong>not exactly the same</strong>&hellip;</li>
</ol>

<p>Here&rsquo;s a checkbox component that takes care of styling and toggling when clicked.
It used it as-is in a couple places, but then kept running into cases where I wanted more fine-grained control.
E.g. I was using some checkboxes as filters and I wanted my <em>Clear filters</em> button to uncheck all the filter checkboxes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">Component</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">styles</span> <span style="color:#f92672">=</span> {...}

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Checkbox</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Component</span> {
  <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">checked</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> }

  <span style="color:#a6e22e">toggle</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setState</span>({ <span style="color:#a6e22e">checked</span><span style="color:#f92672">:</span> <span style="color:#f92672">!</span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">checked</span> })

  <span style="color:#a6e22e">render</span>() {
    <span style="color:#66d9ef">return</span> (
      &lt;<span style="color:#f92672">input</span>
        <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;checkbox&#39;</span>
        <span style="color:#a6e22e">checked</span><span style="color:#f92672">=</span>{<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>.<span style="color:#a6e22e">checked</span>}
        <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">toggle</span>}
        <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>}
      /&gt;
    )
  }
}</code></pre></div>
<p>The tension becomes apparent as I kept adding more and more props to my components to configure them to deal with the variety of use-cases.
It looked ugly and quickly became unmaintainable.</p>

<p>Maybe writing <em>truly</em> reusable UI components is a fool&rsquo;s errand.
I gave up on finding a better way for a while and settled into writing mostly controlled components wired to Redux.
But every time I wrote Redux code just to enable obvious, default behavior (e.g. &ldquo;toggling a checkbox&rdquo;, &ldquo;writing characters into a text input&rdquo;), I longed again for a better way.</p>

<p>I&rsquo;d be lying if I pretended my persistence to find a better way wasn&rsquo;t tied up in my ego as a developer.
I took pride in writing clean, reusable code in scripts and backend code.
But here I was wrestling with a humble checkbox&hellip;
Surely, any great software engineer should be able to write reusable UI components, no?</p>

<hr />

<p>A couple weeks ago I had 2 epiphanies on this subject:</p>

<ol>
<li>From a design perspective, making everything reusable means you <strong>don&rsquo;t understand the problem you are trying to solve</strong>.</li>
<li>The &ldquo;controlled&rdquo; vs &ldquo;uncontrolled&rdquo; is a <strong>false dichotomy</strong>.</li>
</ol>

<p>I realized (1) after reading the first couple chapters from <a href="https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215" target="_blank">Eric Evan&rsquo;s &ldquo;Domain-Driven Design&rdquo;</a>.<sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>
In the rest of this post, I want to focus on how understanding and applying &ldquo;composable behavior&rdquo; frees us from the shackles of (2). It is not only possible to make reusable components that can adapt to many use-cases, it&rsquo;s <em>a joy</em> to write and use them.</p>

<h2 id="case-study-reusable-input">Case study: reusable input</h2>

<p>First things first: I&rsquo;m going to use <a href="https://reactjs.org/docs/hooks-intro.html" target="_blank">React Hooks</a> from here on out instead of <code>state</code> and <code>setState</code>.
Hooks will keep our code focused on solving our problem rather than writing boilerplate code.</p>

<p>For brevity, the examples will use <a href="https://reactjs.org/docs/dom-elements.html#style" target="_blank">inline styles</a>, but I&rsquo;d recommend using CSS-in-JS solutions like <a href="https://emotion.sh/docs/introduction" target="_blank">emotion</a> instead.</p>

<p>With that out of the way, let&rsquo;s look at making a reusable <code>Input.jsx</code> component.</p>

<hr />

<p>An <em>uncontrolled</em> <code>&lt;input/&gt;</code> does the obvious thing out-of-the-box. Namely, as a user types, the characters they are typing appear in the text box.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// UncontrolledInput.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#a6e22e">styles</span> <span style="color:#f92672">=</span> {...}

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">UncontrolledInput</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">setValue</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">input</span>
      <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
      <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
      <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
      <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>}
    /&gt;
  )
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">ControlledInput</span>

<span style="color:#75715e">// App.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UncontrolledInput</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./UncontrolledInput&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">div</span>&gt;
      &lt;<span style="color:#f92672">h1</span>&gt;<span style="color:#a6e22e">My</span> <span style="color:#a6e22e">App</span>&lt;/<span style="color:#f92672">h1</span>&gt;
      &lt;<span style="color:#f92672">UncontrolledInput</span> /&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
  )
}</code></pre></div>
<hr />

<p>An <em>controlled</em> <code>&lt;input/&gt;</code> needs to be wired up, but gives you the flexibility to have the <code>&lt;input/&gt;</code> react to other events. For example, if the <code>&lt;input/&gt;</code> is being used as a search box, you could wire up your app so that clicking a <strong>Clear filters</strong> button also wipes out the text in the <code>&lt;input/&gt;</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// ControlledInput.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#a6e22e">styles</span> <span style="color:#f92672">=</span> {...}

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ControlledInput</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">onChange</span> }) =&gt; {
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">input</span>
      <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
      <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
      <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">onChange</span>}
      <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">styles</span>}
    /&gt;
  )
}

<span style="color:#75715e">// App.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">ControlledInput</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./ControlledInput&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">setValue</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">div</span>&gt;
      &lt;<span style="color:#f92672">h1</span>&gt;<span style="color:#a6e22e">My</span> <span style="color:#a6e22e">App</span>&lt;/<span style="color:#f92672">h1</span>&gt;
      &lt;<span style="color:#f92672">ControlledInput</span>
        <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
        <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
      /&gt;
      &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{() =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#e6db74">&#39;&#39;</span>)}&gt;<span style="color:#a6e22e">Clear</span>&lt;/<span style="color:#f92672">button</span>&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
  )
}</code></pre></div>
<hr />

<p>To unify <code>UncontrolledInput.jsx</code> and <code>ControlledInput.jsx</code>, we need to let the user tells us when to do the default behavior and when to do something custom.
The key insight will be for the user to <strong>explicitly opt-in to default behavior</strong>.</p>

<h2 id="composable-behavior">Composable behavior</h2>

<p>Let&rsquo;s decouple our rendering and behavior.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// Rendering
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Input</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">onChange</span> }) =&gt; {
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">input</span>
      <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
      <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
      <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">onChange</span>}
    /&gt;
  )
}</code></pre></div>
<p>You&rsquo;ll notice that our rendering code is now the same as <code>ControlledInput.jsx</code>.
This is great!
Writing our components as pure functions keeps everything ultra configurable and adaptable.
Now the only challenge is shipping some default behavior that the user can easily, ergonomically opt-in to.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// Behavior
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">useDefaultBehavior</span>(<span style="color:#a6e22e">startingText</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">setValue</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#a6e22e">startingText</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">onChange</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)
  <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">onChange</span> }
}</code></pre></div>
<p>The design here is to create a hook that returns a JS object in the same shape as our component props and delivers the default behavior for our component.
Note that React hooks must have <a href="https://reactjs.org/docs/hooks-custom.html#extracting-a-custom-hook" target="_blank">names starting with &ldquo;use&rdquo;</a>.</p>

<p>Now we can just combine these 2 into 1 file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// Input.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">useDefaultBehavior</span>(<span style="color:#a6e22e">startingText</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">setValue</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#a6e22e">startingText</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">onChange</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)
  <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">onChange</span> }
}

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Input</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">onChange</span> }) =&gt; {
  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">input</span>
      <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
      <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
      <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">onChange</span>}
    /&gt;
  )
}</code></pre></div>
<p>And with that, usage is as simple as:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// App.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Input</span>, { <span style="color:#a6e22e">useDefaultBehavior</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./Input&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">inputDefaults</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useDefaultBehavior</span>()

  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">div</span>&gt;
      &lt;<span style="color:#f92672">h1</span>&gt;<span style="color:#a6e22e">My</span> <span style="color:#a6e22e">App</span>&lt;/<span style="color:#f92672">h1</span>&gt;
      {<span style="color:#75715e">/* opt-in to basic behavior by spreading the props */</span>}
      &lt;<span style="color:#f92672">Input</span> {<span style="color:#a6e22e">...inputDefaults</span>} /&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
  )
}</code></pre></div>
<p>We let the user <strong>compose</strong> the behavior with the component themselves.
This tiny bit of wiring is still ergonomic and is a tiny price to pay for adaptability.</p>

<p>Let&rsquo;s see what that adaptability looks like by trying to create another <code>Input</code> with custom behavior right next to our current, default-behavior <code>Input</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-jsx" data-lang="jsx"><span style="color:#75715e">// App.jsx
</span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Input</span>, { <span style="color:#a6e22e">useDefaultBehavior</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./Input&#39;</span>

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">App</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">inputDefaults</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useDefaultBehavior</span>()

  <span style="color:#75715e">// only allow numbers written to the second input
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// also, allow button to clear the second input
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">value</span>, <span style="color:#a6e22e">setValue</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">onlyNumbers</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span> =&gt; {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">value</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">||</span> isNaN(<span style="color:#a6e22e">value</span>)) {
      <span style="color:#75715e">// value could not be parsed as a number. ignore
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">return</span>
    }
    <span style="color:#a6e22e">setValue</span>(<span style="color:#a6e22e">value</span>)
  }

  <span style="color:#66d9ef">return</span> (
    &lt;<span style="color:#f92672">div</span>&gt;
      &lt;<span style="color:#f92672">h1</span>&gt;<span style="color:#a6e22e">My</span> <span style="color:#a6e22e">App</span>&lt;/<span style="color:#f92672">h1</span>&gt;
      {<span style="color:#75715e">/* opt-in to basic behavior by spreading the props */</span>}
      &lt;<span style="color:#f92672">Input</span> {<span style="color:#a6e22e">...inputDefaults</span>} /&gt;

      {<span style="color:#75715e">/*
</span><span style="color:#75715e">        wire up to complex behavior
</span><span style="color:#75715e">        by treating &lt;Input/&gt; like controlled component
</span><span style="color:#75715e">      */</span>}
      &lt;<span style="color:#f92672">Input</span>
        <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">value</span>}
        <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">e</span> =&gt; <span style="color:#a6e22e">onlyNumbers</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
      /&gt;
      &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{() =&gt; <span style="color:#a6e22e">setValue</span>(<span style="color:#e6db74">&#39;&#39;</span>)}&gt;<span style="color:#a6e22e">Clear</span>&lt;/<span style="color:#f92672">button</span>&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
  )
}</code></pre></div>
<p>Behold the power of composable behavior!</p>

<p>Like the power to <a href="https://twitter.com/dan_abramov/status/1021850499618955272" target="_blank">compose components</a><sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>, this pattern let&rsquo;s you ergonomically choose between built-in behaviors and custom ones to fit the needs of every use-case in your app.</p>

<h2 id="fp">FP?</h2>

<p>This isn&rsquo;t a new idea.
Composing behavior is the central tenet of <a href="https://en.wikipedia.org/wiki/Functional_programming" target="_blank">Functional Programming</a>, though in that context we&rsquo;d say <a href="https://en.wikipedia.org/wiki/Functional_programming#First-class_and_higher-order_functions" target="_blank">&ldquo;Functions can be passed as arguments to other functions&rdquo;</a>.</p>

<p>It makes me happy to see <a href="https://overreacted.io/algebraic-effects-for-the-rest-of-us/#a-note-on-purity" target="_blank">React borrowing from FP</a> more and more where it makes sense.
No need to reinvent the wheel for composable behavior.</p>

<p>Ship functions (as hooks) alongside stateless, controlled components and let the user compose their symphony. 🚀</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">See <a href="https://varun.ca/flattening-deep-hierarchies-of-components/" target="_blank">this article</a> for more on composing components
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/react/'>React</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/posts/tidy-processes/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Tidy Processes in Python</a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/pcattori' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:pcattori@gmail.com' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/pcattori' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li><li>
        <a href='https://www.youtube.com/channel/UCIUapzIuBFsF3z220FpwYSQ' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Youtube account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z" />
  <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02" />
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2019 Pedro Cattori </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.67d669ac.js'></script>

</body>

</html>

